{% load slippers %}
<div
    id="payment-status"
    hx-get="{% url 'payments:poll' payment_ref=payment.reference %}"
    hx-trigger="every 3s"
    hx-target="#payment-panel"
    hx-swap="innerHTML"
    class="space-y-6"
    data-motion
>
    <div class="flex flex-col items-center justify-center py-8">
        {% #loading_state size="lg" %}{% /loading_state %}
        <h3 class="mt-4 text-lg font-semibold">Processing Payment</h3>
        <p class="mt-2 text-sm text-muted-foreground text-center">
            Please complete the payment on your phone.<br>
            A prompt should appear on your mobile device.
        </p>
    </div>

    {% #alert variant="default" icon="info" %}
        <div class="space-y-2 text-sm">
            <p><strong>Reference:</strong> {{ payment.reference }}</p>
            <p><strong>Method:</strong> {{ payment.get_method_display }}</p>
            <p><strong>Phone:</strong> {{ payment.phone_number }}</p>
            <p><strong>Amount:</strong> {{ payment.amount }} XAF</p>
        </div>
    {% /alert %}

    <p class="text-center text-xs text-muted-foreground">
        Do not close this page. We are waiting for confirmation...
    </p>
</div>

<script>
    if (typeof motion !== 'undefined') {
        motion.animate(
            "[data-motion]",
            { opacity: [0, 1], y: [8, 0] },
            { duration: 0.25 }
        );
    }
</script>
