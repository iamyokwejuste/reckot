{% extends 'layouts/dashboard.html' %}
{% load slippers %}
{% load i18n %}

{% block title %}{% trans "My Events" %} - Reckot{% endblock %}

{% block breadcrumbs %}
{% #breadcrumb class="mb-4" %}
    {% #breadcrumb_item href="/" %}Home{% /breadcrumb_item %}
    {% #breadcrumb_separator %}{% /breadcrumb_separator %}
    {% #breadcrumb_item %}Events{% /breadcrumb_item %}
{% /breadcrumb %}
{% endblock %}

{% block header_title %}
<div>
    <h1 class="text-lg font-semibold">Your Events</h1>
    <p class="text-sm text-muted-foreground">Manage your events and tickets</p>
</div>
{% endblock %}

{% block header_actions %}
<a href="{% url 'events:create' %}">
    {% #button variant="default" size="sm" %}
        <i data-lucide="plus" class="w-4 h-4"></i>
        Create Event
    {% /button %}
</a>
{% endblock %}

{% block content %}
<div>
    {% if events %}
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {% for event in events %}
        {% #card interactive=True class="!p-4" %}
            <div class="flex items-start justify-between mb-3">
                <div class="flex-1 min-w-0">
                    <a href="{% url 'events:dashboard' event.organization.slug event.slug %}" class="text-base font-semibold hover:text-primary transition-colors line-clamp-1">
                        {{ event.title }}
                    </a>
                    <p class="text-sm text-muted-foreground">{{ event.organization.name }}</p>
                </div>
                {% if event.state == 'PUBLISHED' %}
                {% #badge variant="success" %}Live{% /badge %}
                {% elif event.state == 'DRAFT' %}
                {% #badge %}Draft{% /badge %}
                {% else %}
                {% #badge variant="warning" %}{{ event.state }}{% /badge %}
                {% endif %}
            </div>

            <div class="text-sm text-muted-foreground line-clamp-2 mb-3 prose prose-sm dark:prose-invert max-w-none">{{ event.description|safe }}</div>

            <div class="flex items-center gap-3 text-xs text-muted-foreground mb-4">
                <span class="flex items-center gap-1">
                    <i data-lucide="calendar" class="h-3.5 w-3.5"></i>
                    {{ event.start_at|date:"M d, Y" }}
                </span>
                {% if event.location %}
                <span class="flex items-center gap-1">
                    <i data-lucide="map-pin" class="h-3.5 w-3.5"></i>
                    {{ event.location|truncatewords:2 }}
                </span>
                {% endif %}
            </div>

            <div class="pt-3 border-t border-border flex flex-wrap gap-2">
                <a href="{% url 'events:dashboard' event.organization.slug event.slug %}">
                    {% #button variant="outline" size="sm" %}
                        <i data-lucide="settings" class="w-3.5 h-3.5"></i>
                        Manage
                    {% /button %}
                </a>
                <a href="{% url 'checkin:dashboard' event.organization.slug event.slug %}">
                    {% #button variant="outline" size="sm" %}
                        <i data-lucide="scan" class="w-3.5 h-3.5"></i>
                        Check-in
                    {% /button %}
                </a>
                <a href="{% url 'reports:export_center' event.organization.slug event.slug %}">
                    {% #button variant="outline" size="sm" %}
                        <i data-lucide="download" class="w-3.5 h-3.5"></i>
                        Export
                    {% /button %}
                </a>
            </div>
        {% /card %}
        {% endfor %}
    </div>
    {% else %}
    {% #empty_state icon="calendar" title="No events yet" description="Get started by creating your first event" %}
        <a href="{% url 'events:create' %}">
            {% #button variant="default" %}
                <i data-lucide="plus" class="w-4 h-4"></i>
                Create Event
            {% /button %}
        </a>
    {% /empty_state %}
    {% endif %}
</div>
{% endblock %}
