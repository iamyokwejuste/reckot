{% extends "layouts/dashboard.html" %}
{% load slippers i18n %}

{% block title %}{% trans "New Template" %} - {{ organization.name }} - Reckot{% endblock %}

{% block header_title %}
<div>
    <h1 class="text-lg font-semibold">{% trans "New Message Template" %}</h1>
    <p class="text-sm text-muted-foreground">{% trans "Create a reusable template for your campaigns" %}</p>
</div>
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <form method="post" class="space-y-6" x-data="{ templateType: 'EMAIL' }">
        {% csrf_token %}

        <div class="card p-6 space-y-5">
            <h2 class="font-semibold flex items-center gap-2">
                <i data-lucide="file-text" class="w-4 h-4"></i>
                {% trans "Template Details" %}
            </h2>

            <div>
                <label for="name" class="block text-sm font-medium mb-2">{% trans "Template Name" %}</label>
                <input type="text" name="name" id="name" required placeholder="{% trans "e.g., Event Reminder" %}"
                       class="input">
                <p class="text-xs text-muted-foreground mt-1">{% trans "Internal name to identify this template" %}</p>
            </div>

            <div>
                <label class="block text-sm font-medium mb-2">{% trans "Template Type" %}</label>
                <div class="flex p-1 bg-muted rounded-lg">
                    <button type="button" @click="templateType = 'EMAIL'"
                            class="flex-1 flex items-center justify-center gap-2 py-2 px-3 text-sm font-medium rounded-md transition-all"
                            :class="templateType === 'EMAIL' ? 'bg-background text-foreground shadow-sm' : 'text-muted-foreground'">
                        <i data-lucide="mail" class="w-4 h-4"></i>
                        {% trans "Email" %}
                    </button>
                    <button type="button" @click="templateType = 'SMS'"
                            class="flex-1 flex items-center justify-center gap-2 py-2 px-3 text-sm font-medium rounded-md transition-all"
                            :class="templateType === 'SMS' ? 'bg-background text-foreground shadow-sm' : 'text-muted-foreground'">
                        <i data-lucide="message-square" class="w-4 h-4"></i>
                        {% trans "SMS" %}
                    </button>
                </div>
                <input type="hidden" name="template_type" :value="templateType">
            </div>
        </div>

        <div class="card p-6 space-y-5">
            <h2 class="font-semibold flex items-center gap-2">
                <i data-lucide="pen-line" class="w-4 h-4"></i>
                {% trans "Content" %}
            </h2>

            <div x-show="templateType === 'EMAIL'">
                <label for="subject" class="block text-sm font-medium mb-2">{% trans "Subject Line" %}</label>
                <input type="text" name="subject" id="subject" placeholder="{% trans "Your email subject" %}"
                       class="input">
            </div>

            <div>
                <label for="body" class="block text-sm font-medium mb-2">{% trans "Message Body" %}</label>
                <textarea name="body" id="body" rows="10" required
                          placeholder="{% trans "Write your message template here..." %}"
                          class="input resize-none font-mono text-sm"></textarea>
                <div class="mt-3 p-4 rounded-lg bg-muted/50">
                    <p class="text-xs font-medium mb-2">{% trans "Available Variables" %}</p>
                    <div class="flex flex-wrap gap-2">
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}name{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}first_name{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}last_name{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}email{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}ticket_type{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}ticket_code{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}event_name{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}event_date{{ "}}" }}</code>
                        <code class="px-2 py-1 rounded bg-background text-xs">{{ "{{" }}event_location{{ "}}" }}</code>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex items-center justify-between gap-4">
            <a href="{% url 'messaging:template_list' org_slug=organization.slug %}">
                {% #button variant="outline" %}
                    {% trans "Cancel" %}
                {% /button %}
            </a>
            {% #button variant="default" type="submit" %}
                <i data-lucide="save" class="w-4 h-4"></i>
                {% trans "Save Template" %}
            {% /button %}
        </div>
    </form>
</div>
{% endblock %}
