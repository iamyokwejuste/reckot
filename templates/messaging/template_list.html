{% extends "layouts/dashboard.html" %}
{% load slippers i18n %}

{% block title %}{% trans "Message Templates" %} - {{ organization.name }} - Reckot{% endblock %}

{% block header_title %}
<div class="min-w-0">
    <h1 class="text-lg font-semibold truncate">{% trans "Message Templates" %}</h1>
    <p class="text-sm text-muted-foreground hidden md:block">{% trans "Reusable templates for your campaigns" %}</p>
</div>
{% endblock %}

{% block header_actions %}
<a href="{% url 'messaging:template_create' org_slug=organization.slug %}">
    {% #button variant="default" %}
        <i data-lucide="plus" class="w-4 h-4"></i>
        {% trans "New Template" %}
    {% /button %}
</a>
{% endblock %}

{% block content %}
<div class="space-y-6">
    <div class="flex items-center gap-3">
        <a href="{% url 'messaging:campaign_list' org_slug=organization.slug %}">
            {% #button variant="outline" size="sm" %}
                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                {% trans "Back to Campaigns" %}
            {% /button %}
        </a>
        <span class="text-sm text-muted-foreground">{{ templates.count }} {% trans "template" %}{{ templates.count|pluralize }}</span>
    </div>

    {% if templates %}
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for template in templates %}
        <div class="card p-5 hover:shadow-md transition-shadow">
            <div class="flex items-start justify-between mb-3">
                <div class="h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center">
                    {% if template.template_type == 'EMAIL' %}
                    <i data-lucide="mail" class="w-5 h-5 text-primary"></i>
                    {% else %}
                    <i data-lucide="message-square" class="w-5 h-5 text-primary"></i>
                    {% endif %}
                </div>
                <span class="badge badge-outline">{{ template.get_template_type_display }}</span>
            </div>
            <h3 class="font-semibold">{{ template.name }}</h3>
            {% if template.subject %}
            <p class="text-sm text-muted-foreground mt-1 truncate">{{ template.subject }}</p>
            {% endif %}
            <p class="text-sm text-muted-foreground mt-2 line-clamp-2">{{ template.body|truncatechars:100 }}</p>
            <div class="flex items-center justify-between mt-4 pt-4 border-t border-border">
                <span class="text-xs text-muted-foreground">{{ template.created_at|date:"M d, Y" }}</span>
                <div class="flex items-center gap-2">
                    {% #button variant="outline" size="sm" type="button" attrs="x-data x-on:click=\"navigator.clipboard.writeText('{{ template.body|escapejs }}'); $el.innerHTML='<i data-lucide=&quot;check&quot; class=&quot;w-3 h-3&quot;></i>'; setTimeout(() => { $el.innerHTML='<i data-lucide=&quot;copy&quot; class=&quot;w-3 h-3&quot;></i>'; lucide.createIcons(); }, 2000); lucide.createIcons();\"" %}
                        <i data-lucide="copy" class="w-3 h-3"></i>
                    {% /button %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="card p-12 text-center">
        <div class="h-16 w-16 rounded-full bg-muted flex items-center justify-center mx-auto mb-4">
            <i data-lucide="file-text" class="w-8 h-8 text-muted-foreground"></i>
        </div>
        <h3 class="font-semibold text-lg">{% trans "No templates yet" %}</h3>
        <p class="text-muted-foreground mt-1">{% trans "Create reusable templates for your campaigns" %}</p>
        <a href="{% url 'messaging:template_create' org_slug=organization.slug %}" class="mt-6 inline-block">
            {% #button variant="default" %}
                <i data-lucide="plus" class="w-4 h-4"></i>
                {% trans "Create Template" %}
            {% /button %}
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
