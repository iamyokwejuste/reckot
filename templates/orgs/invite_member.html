{% extends 'layouts/dashboard.html' %}
{% load slippers i18n %}

{% block title %}{% trans "Invite Member" %} - {{ organization.name }} - Reckot{% endblock %}

{% block header_title %}
<div class="min-w-0">
    <h1 class="text-lg font-semibold truncate">{% trans "Invite Team Member" %}</h1>
    <p class="text-sm text-muted-foreground hidden md:block">{{ organization.name }}</p>
</div>
{% endblock %}

{% block header_actions %}
<a href="{% url 'orgs:members' organization.slug %}">
    {% #button variant="outline" size="sm" %}
        <i data-lucide="arrow-left" class="w-4 h-4"></i>
        {% trans "Back" %}
    {% /button %}
</a>
{% endblock %}

{% block content %}
<div class="max-w-lg mx-auto">
    <div class="card p-6">
        <form method="post">
            {% csrf_token %}

            <div class="space-y-4">
                <div>
                    <label for="email" class="block text-sm font-medium mb-2">{% trans "Email address" %}</label>
                    <input type="email" name="email" id="email" required
                           placeholder="colleague@email.com" class="input">
                    <p class="text-xs text-muted-foreground mt-1">{% trans "They'll receive an invitation email" %}</p>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">{% trans "Role" %}</label>
                    {% select name="role" options=roles value="MEMBER" label=_("Member") placeholder=_("Select a role") required=True %}
                </div>

                <div>
                    <label for="message" class="block text-sm font-medium mb-2">{% trans "Personal Message (optional)" %}</label>
                    <textarea name="message" id="message" rows="3"
                              placeholder="{% trans "Add a personal message to the invitation..." %}"
                              class="input resize-none"></textarea>
                </div>
            </div>

            <div class="mt-6 flex gap-3">
                {% #button variant="default" type="submit" class="flex-1" %}
                    <i data-lucide="send" class="w-4 h-4"></i>
                    {% trans "Send Invitation" %}
                {% /button %}
            </div>
        </form>
    </div>

    <div class="mt-6 card p-6">
        <div class="flex items-start gap-3 mb-4">
            <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0">
                <i data-lucide="link" class="w-5 h-5 text-primary"></i>
            </div>
            <div>
                <h3 class="font-medium">{% trans "Shareable Invitation Link" %}</h3>
                <p class="text-sm text-muted-foreground mt-1">
                    {% trans "Generate a link that can be shared with multiple people" %}
                </p>
            </div>
        </div>

        {% if request.session.generated_invite_url %}
        <div class="mb-4 p-4 rounded-lg bg-success/10 border border-success/20" data-controller="clipboard" data-clipboard-text="{{ request.session.generated_invite_url }}">
            <p class="text-sm font-medium text-success mb-2">{% trans "Link Generated!" %}</p>
            <div class="flex gap-2">
                <input type="text" readonly
                       value="{{ request.session.generated_invite_url }}"
                       class="input flex-1 font-mono text-sm select-all"
                       onclick="this.select()">
                {% #button variant="outline" size="sm" data-action="click->clipboard#copy" type="button" %}
                    <i data-lucide="copy" class="w-4 h-4"></i>
                    {% trans "Copy" %}
                {% /button %}
            </div>
            <p class="text-xs text-muted-foreground mt-2">
                {% trans "Role" %}: <span class="font-medium">{{ request.session.generated_invite_role }}</span>
            </p>
        </div>
        {% endif %}

        <form method="post" action="{% url 'orgs:generate_invite_link' organization.slug %}">
            {% csrf_token %}
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">{% trans "Select Role for Link" %}</label>
                    {% select name="role" options=roles value="MEMBER" label=_("Member") placeholder=_("Select a role") required=True %}
                    <p class="text-xs text-muted-foreground mt-1">
                        {% trans "Anyone with this link will join as this role" %}
                    </p>
                </div>
            </div>

            <div class="mt-4">
                {% #button variant="outline" type="submit" class="w-full" %}
                    <i data-lucide="link-2" class="w-4 h-4"></i>
                    {% trans "Generate Link" %}
                {% /button %}
            </div>
        </form>
    </div>

    <div class="mt-6 card p-4">
        <h3 class="text-sm font-medium mb-3">{% trans "Role Descriptions" %}</h3>
        <div class="space-y-3 text-sm">
            <div class="flex gap-3">
                {% #badge variant="secondary" %}{% trans "Admin" %}{% /badge %}
                <p class="text-muted-foreground">{% trans "Full access except deleting the organization" %}</p>
            </div>
            <div class="flex gap-3">
                {% #badge %}{% trans "Manager" %}{% /badge %}
                <p class="text-muted-foreground">{% trans "Create events, manage tickets, view reports" %}</p>
            </div>
            <div class="flex gap-3">
                {% #badge %}{% trans "Member" %}{% /badge %}
                <p class="text-muted-foreground">{% trans "Create events, manage tickets, check-in attendees" %}</p>
            </div>
            <div class="flex gap-3">
                {% #badge %}{% trans "Viewer" %}{% /badge %}
                <p class="text-muted-foreground">{% trans "View-only access to reports and analytics" %}</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
